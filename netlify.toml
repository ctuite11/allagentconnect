[[headers]]
  for = "/*"
  [headers.values]
    X-Robots-Tag = "all"

# Favicon - no caching to ensure Google picks up updates
[[headers]]
  for = "/favicon.png"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  for = "/favicon.ico"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Canonical OG image - no long-term caching so social scrapers can refresh
[[headers]]
  for = "/og/aac-og-2026-01-25.jpg"
  [headers.values]
    Content-Type = "image/jpeg"
    Cache-Control = "public, max-age=0, must-revalidate"

# Versioned OG images - immutable caching is fine
[[headers]]
  for = "/og/aac-og-v*.png"
  [headers.values]
    Content-Type = "image/png"
    Cache-Control = "public, max-age=31536000, immutable"

[[edge_functions]]
  path = "/property/*"
  function = "social-preview"

[[edge_functions]]
  path = "/api/auth/request-password-reset"
  function = "request-password-reset"

[[redirects]]
  from = "/api/send-pending-approval-email"
  to = "/.netlify/functions/send-pending-approval-email"
  status = 200

[[redirects]]
  from = "/api/send-password-changed-email"
  to = "/.netlify/functions/send-password-changed-email"
  status = 200

# Repliers IDX proxy endpoints (secure server-side)
[[redirects]]
  from = "/api/repliers/health"
  to = "/.netlify/functions/repliers-health"
  status = 200
  force = true

[[redirects]]
  from = "/api/repliers/listings"
  to = "/.netlify/functions/repliers-listings"
  status = 200
  force = true

[[redirects]]
  from = "/api/repliers/listing/*"
  to = "/.netlify/functions/repliers-listing-detail"
  status = 200
  force = true

[[redirects]]
  from = "/api/repliers/autocomplete"
  to = "/.netlify/functions/repliers-autocomplete"
  status = 200
  force = true

# Functions configuration
[functions]
  node_bundler = "esbuild"

# Scheduled email worker - runs every minute to drain email queue
[functions."email-worker"]
  schedule = "* * * * *"
